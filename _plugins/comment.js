var siteid=1;!function(t){var e={init:function(n){return this.each(function(){var o=this,a=t(o).empty();o.opt=t.extend(!0,{},t.fn.raty.defaults,n),a.data("settings",o.opt),o.opt.number=e.between(o.opt.number,0,20),"/"!=o.opt.path.substring(o.opt.path.length-1,o.opt.path.length)&&(o.opt.path+="/"),"function"==typeof o.opt.score&&(o.opt.score=o.opt.score.call(o)),o.opt.score&&(o.opt.score=e.between(o.opt.score,0,o.opt.number));for(var i=1;i<=o.opt.number;i++)t("<img />",{src:o.opt.path+(!o.opt.score||o.opt.score<i?o.opt.starOff:o.opt.starOn),alt:i,title:i<=o.opt.hints.length&&null!==o.opt.hints[i-1]?o.opt.hints[i-1]:i}).appendTo(o),o.opt.space&&a.append(i<o.opt.number?"&#160;":"");o.stars=a.children('img:not(".raty-cancel")'),o.score=t("<input />",{type:"hidden",name:o.opt.scoreName}).appendTo(o),o.opt.score&&o.opt.score>0&&(o.score.val(o.opt.score),e.roundStar.call(o,o.opt.score)),o.opt.iconRange&&e.fill.call(o,o.opt.score),e.setTarget.call(o,o.opt.score,o.opt.targetKeep);var r=o.opt.space?4:0;o.opt.width||(o.opt.number,o.opt.size,o.opt.number);o.opt.cancel&&(o.cancel=t("<img />",{src:o.opt.path+o.opt.cancelOff,alt:"x",title:o.opt.cancelHint,class:"raty-cancel"}),"left"==o.opt.cancelPlace?a.prepend("&#160;").prepend(o.cancel):a.append("&#160;").append(o.cancel),o.opt.size),o.opt.readOnly?(e.fixHint.call(o),o.cancel&&o.cancel.hide()):(a.css("cursor","pointer"),e.bindAction.call(o))})},between:function(t,e,n){return Math.min(Math.max(parseFloat(t),e),n)},bindAction:function(){var n=this,o=t(n);o.mouseleave(function(){var t=n.score.val()||void 0;e.initialize.call(n,t),e.setTarget.call(n,t,n.opt.targetKeep),n.opt.mouseover&&n.opt.mouseover.call(n,t)});var a=n.opt.half?"mousemove":"mouseover";n.opt.cancel&&n.cancel.mouseenter(function(){t(this).attr("src",n.opt.path+n.opt.cancelOn),n.stars.attr("src",n.opt.path+n.opt.starOff),e.setTarget.call(n,null,!0),n.opt.mouseover&&n.opt.mouseover.call(n,null)}).mouseleave(function(){t(this).attr("src",n.opt.path+n.opt.cancelOff),n.opt.mouseover&&n.opt.mouseover.call(n,n.score.val()||null)}).click(function(t){n.score.removeAttr("value"),n.opt.click&&n.opt.click.call(n,null,t)}),n.stars.bind(a,function(a){var i=parseInt(this.alt,10);if(n.opt.half){var r=parseFloat((a.pageX-t(this).offset().left)/n.opt.size),l=r>.5?1:.5;i=parseFloat(this.alt)-1+l,e.fill.call(n,i),n.opt.precision&&(i=i-l+r),e.showHalf.call(n,i)}else e.fill.call(n,i);o.data("score",i),e.setTarget.call(n,i,!0),n.opt.mouseover&&n.opt.mouseover.call(n,i,a)}).click(function(t){n.score.val(n.opt.half||n.opt.precision?o.data("score"):this.alt),n.opt.click&&n.opt.click.call(n,n.score.val(),t)})},cancel:function(n){return t(this).each(function(){var o=this;if(!0===t(o).data("readonly"))return this;n?e.click.call(o,null):e.score.call(o,null),o.score.removeAttr("value")})},click:function(n){return t(this).each(function(){if(!0===t(this).data("readonly"))return this;e.initialize.call(this,n),this.opt.click?this.opt.click.call(this,n):e.error.call(this,'you must add the "click: function(score, evt) { }" callback.'),e.setTarget.call(this,n,!0)})},error:function(e){t(this).html(e),t.error(e)},fill:function(t){for(var e,n,o,a=this,i=a.stars.length,r=0,l=1;l<=i;l++)e=a.stars.eq(l-1),a.opt.iconRange&&a.opt.iconRange.length>r?(n=a.opt.iconRange[r],o=a.opt.single?l==t?n.on||a.opt.starOn:n.off||a.opt.starOff:l<=t?n.on||a.opt.starOn:n.off||a.opt.starOff,l<=n.range&&e.attr("src",a.opt.path+o),l==n.range&&r++):(o=a.opt.single?l==t?a.opt.starOn:a.opt.starOff:l<=t?a.opt.starOn:a.opt.starOff,e.attr("src",a.opt.path+o))},fixHint:function(){var e=t(this),n=parseInt(this.score.val(),10),o=this.opt.noRatedMsg;!isNaN(n)&&n>0&&(o=n<=this.opt.hints.length&&null!==this.opt.hints[n-1]?this.opt.hints[n-1]:n),e.data("readonly",!0).css("cursor","default").attr("title",o),this.score.attr("readonly","readonly"),this.stars.attr("title",o)},getScore:function(){var e,n=[];return t(this).each(function(){e=this.score.val(),n.push(e?parseFloat(e):void 0)}),n.length>1?n:n[0]},readOnly:function(n){return this.each(function(){var o=t(this);if(o.data("readonly")===n)return this;this.cancel&&(n?this.cancel.hide():this.cancel.show()),n?(o.unbind(),o.children("img").unbind(),e.fixHint.call(this)):(e.bindAction.call(this),e.unfixHint.call(this)),o.data("readonly",n)})},reload:function(){return e.set.call(this,{})},roundStar:function(t){var e=(t-Math.floor(t)).toFixed(2);if(e>this.opt.round.down){var n=this.opt.starOn;e<this.opt.round.up&&this.opt.halfShow?n=this.opt.starHalf:e<this.opt.round.full&&(n=this.opt.starOff),this.stars.eq(Math.ceil(t)-1).attr("src",this.opt.path+n)}},score:function(){return arguments.length?e.setScore.apply(this,arguments):e.getScore.call(this)},set:function(e){return this.each(function(){var n=t(this),o=n.data("settings"),a=n.clone().removeAttr("style").insertBefore(n);n.remove(),a.raty(t.extend(o,e))}),t(this.selector)},setScore:function(n){return t(this).each(function(){if(!0===t(this).data("readonly"))return this;e.initialize.call(this,n),e.setTarget.call(this,n,!0)})},setTarget:function(n,o){if(this.opt.target){var a=t(this.opt.target);0==a.length&&e.error.call(this,"target selector invalid or missing!");var i=n;i=o&&void 0!==i?"hint"==this.opt.targetType?null===i&&this.opt.cancel?this.opt.cancelHint:this.opt.hints[Math.ceil(i-1)]:this.opt.precision?parseFloat(i).toFixed(1):parseInt(i,10):this.opt.targetText,this.opt.targetFormat.indexOf("{score}")<0&&e.error.call(this,'template "{score}" missing!'),null!==n&&(i=this.opt.targetFormat.toString().replace("{score}",i)),a.is(":input")?a.val(i):a.html(i)}},showHalf:function(t){var e=(t-Math.floor(t)).toFixed(1);e>0&&e<.6&&this.stars.eq(Math.ceil(t)-1).attr("src",this.opt.path+this.opt.starHalf)},initialize:function(t){t=t?e.between(t,0,this.opt.number):0,e.fill.call(this,t),t>0&&(this.opt.halfShow&&e.roundStar.call(this,t),this.score.val(t))},unfixHint:function(){for(var e=0;e<this.opt.number;e++)this.stars.eq(e).attr("title",e<this.opt.hints.length&&null!==this.opt.hints[e]?this.opt.hints[e]:e);t(this).data("readonly",!1).css("cursor","pointer").removeAttr("title"),this.score.attr("readonly","readonly")}};t.fn.raty=function(n){return e[n]?e[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void t.error("Method "+n+" does not exist!"):e.init.apply(this,arguments)},t.fn.raty.defaults={cancel:!1,cancelHint:"cancel this rating!",cancelOff:"cancel-off.png",cancelOn:"cancel-on.png",cancelPlace:"left",click:void 0,half:!1,halfShow:!0,hints:["bad","poor","regular","good","gorgeous"],iconRange:void 0,mouseover:void 0,noRatedMsg:"not rated yet",number:5,path:"img/",precision:!1,round:{down:.25,full:.6,up:.76},readOnly:!1,score:void 0,scoreName:"score",single:!1,size:16,space:!0,starHalf:"star-half.png",starOff:"star-off.png",starOn:"star-on.png",target:void 0,targetFormat:"{score}",targetKeep:!1,targetText:"",targetType:"hint"}}(jQuery);var journalItem={JournalType:"status",Title:"",Summary:"",Body:"",ItemData:null,Security:"E"},cancelRequest=!1;function pluginInit(){journalOptions.fullName.length&&$(".txtFullName").val(journalOptions.fullName),journalOptions.email.length&&$(".txtEmail").val(journalOptions.email),$(".cmtname").val($(".txtFullName").val()),$(".cmtemail").val($(".txtEmail").val()),$(".jcmt").each(function(t){$(this).journalComments(commentOpts)}),$('a[id^="cmtbtn-"]').bind("click",function(t){t.preventDefault();var e=$(this).attr("id").replace("cmtbtn-",""),n=$("#jcmt-"+e+" .cmteditarea"),o=$("#jcmt-"+e+" .cmtbtn"),a=$("#jcmt-"+e+" .cmtbtn a"),i=$("#jcmt-"+e+" .cmtbtn .cmtinfo");if("none"==n.css("display"))n.show(),a.addClass("disabled"),o.show();else{var r=$("#jcmt-"+e+" .cmteditor"),l=$("#jcmt-"+e+" .editorPlaceholder");r.animate({height:"0"},400,function(){o.hide(),a.addClass("disabled"),i.hide(),r.text("").hide(),n.hide(),l.show()})}}),$('a[id^="like-"]').bind("click",likeComment)}function buildLikes(t,e){$("#like-"+e).fadeOut(function(){$(this).html(t).fadeIn()})}function likeComment(){return journalPost("Like",buildLikes,$(this).attr("id").replace("like-","")),!1}function journalReport(t){journalPost("Report",reportCallback,t.id.replace("report-",""))}function reportCallback(t,e){$("#report-"+e).html(journalOptions.reportSuccessfullyText)}function journalDelete(t){confirm(journalOptions.deleteConfirmText)&&journalPost("Delete",deleteCallback,t.parentNode.parentNode.id.replace("jid-",""))}function deleteCallback(t,e){$("#jid-"+e).slideUp(function(){$(this).remove()})}function journalPost(t,e,n){$.ajax({type:"POST",url:journalOptions.siteRoot+"/Product/Services/CommentService.asmx/"+t,data:{commentId:n},success:function(t){void 0!==e&&e(t,n)},error:function(t,e,n){alert(n)}})}!function(t,e){"use strict";t.fn.journalTools=function(n){t.fn.journalTools.defaultOptions={placeHolder:".journalPlaceholder",shareButton:".btnShare",closeButton:".journalClose",info:".journalInfo",fullName:".txtFullName",email:".txtEmail",content:".journalContent",items:".journalItems",pager:".commentpager a",securityMenu:".securityMenu",maxLength:2e3};var o=t.extend({},t.fn.journalTools.defaultOptions,n),a=this,i=a.find(o.placeHolder),r=a.find(o.shareButton),l=a.find(o.closeButton),s=a.find(o.info),c=a.find(o.fullName),u=a.find(o.email),p=a.find(o.content),d=a.find(o.items),f=a.find(o.pager),h=o.maxLength,m=a.find(o.securityMenu),v=function(t){r.removeClass("disabled"),r.unbind("keypress",v)};m.find(".handle").click(function(){m.toggle()}),t(o.securityMenu+" input").click(function(){journalItem.Security=t(this).val()}),i.click(function(){g()}),t(".less").click(function(){"block"!=t(".journalInfo").css("display")&&g()}),l.click(function(){l.hide(),s.hide(),!1,r.addClass("disabled"),p.data("linkedUp",!1),p.unbind("keypress",v),p.animate({height:"0"},400,function(){p.val("").hide(),i.show(),(journalItem={}).JournalType="status",journalItem.Title="",journalItem.Summary="",journalItem.Body="",journalItem.ItemData=null,journalItem.Security="E",journalItem.Tags=[],journalItem.Users=[]})}),p.bind("keypress",function(t){if(8!=t.keyCode&&46!=t.keyCode)return!(p.val().length>=h)&&void 0}),p.bind("paste",function(t){setTimeout(function(){if(p.val(p.val()),p.val().length>=h){var t=p.val().substring(0,h);p.val(t)}},100)});var g=function(){i.hide(),s.show(),r.addClass("disabled"),p.show().animate({height:"+=65"},400,function(){!0,p.focus(),p.bind("keypress",v),l.show()})};r.click(function(e){cancelRequest=!0,e.preventDefault();var n={};if(n.productId=journalOptions.productId,n.commentType=r.parents(".commentpanel").attr("data-type"),n.fullName=encodeURIComponent(c.val()),n.email=encodeURIComponent(u.val()),n.content=encodeURIComponent(p.val()),n.rating=t(".rating").find("input[name='score']").val(),n.siteid=siteid,""==n.content||"%3Cbr%3E"==n.content)return alert(journalOptions.contentRequiredText),p.focus(),!1;if(""==n.fullName)return alert(journalOptions.fullNameRequiredText),c.focus(),!1;var o=p.val();if(""==(o=o.replace(/<(?:.|\n)*?>/gm,"").replace(/\s+/g,"").replace(/&nbsp;/g,"")))return alert(journalOptions.contentInvalidText),p.focus(),!1;t.ajax({type:"POST",url:"/Product/Services/CommentService.asmx/Create",data:n,success:function(e){""!=e&&" "!=e&&(t(e).hide().prependTo(d).fadeIn(),p.val(""),pluginInit(),t(".btnloadcm").click())},error:function(t,e,n){alert(n)}})}),f.bind("click",function(n){n.preventDefault();var o=t(this),a=o.attr("href"),i=a.split("cmtpg=");0==isNaN(parseInt(i[1]))&&parseInt(i[1])>0&&t.ajax({type:"POST",url:journalOptions.siteRoot+"/Product/Services/CommentService.asmx/GetList",data:{productId:journalOptions.productId,commentType:t(this).parents(".commentpanel").attr("data-type"),parentId:-1,pageNumber:parseInt(i[1]),pageSize:journalOptions.pageSize,siteid:siteid},success:function(n){n.length>0&&(d.html(n),a!=e.location&&e.history.pushState({path:a},"",a),o.parent().find("a").removeClass("SelectedPage"),o.addClass("SelectedPage"),pluginInit(),t("html, body").animate({scrollTop:d.offset().top},0,"linear")),"undefined"!=typeof callback&&callback(n)},error:function(t,e,n){alert(n)}})})}}(jQuery,window),function(t,e){t.fn.journalComments=function(e){t.fn.journalComments.defaultOptions={maxLength:2e3};var n=t.extend({},t.fn.journalComments.defaultOptions,e),o=t(this).attr("id"),a=n.maxLength,i=t("#"+o+"-txt"),r=t("#"+o+" .editorPlaceholder"),l=t("#"+o+" .cmtbtn a"),s=t("#"+o+" .cmtbtn .cmtinfo"),c=t("#"+o+" .cmtbtn input.cmtname"),u=t("#"+o+" .cmtbtn input.cmtemail"),p=t("#"+o+" .miniclose");function d(){confirm(journalOptions.deleteConfirmText)&&(jid=t(this).parent().attr("id").replace("cmt-",""),t.ajax({type:"POST",url:journalOptions.siteRoot+"/Product/Services/CommentService.asmx/Delete",data:{commentId:jid},success:function(t){},error:function(t,e,n){alert(n)}}),t(this).parent().fadeOut(function(){var e=t(this).parent(),n=t(this).attr("id");t(this).animate({height:"0"},400,function(){e.remove("#"+n)})}))}r.unbind("click"),l.unbind("click"),r.click(function(){r.hide(),l.addClass("disabled"),s.show(),i.show().animate({height:"+=45"},400,function(){i.focus(),i.bind("keypress",f)})}),p.bind("click",d),i.bind("paste",function(t){setTimeout(function(){if(i.val(i.val()),i.val().length>a){var t=i.val().substring(0,a);i.val(t)}},100),f(t)});var f=function(t){l.removeClass("disabled"),i.unbind("keypress",f)};l.click(function(e){e.preventDefault();var n=o.replace("jcmt-",""),a={};a.productId=journalOptions.productId,a.commentId=n,a.Comment=encodeURIComponent(i.val()),a.fullName=encodeURIComponent(c.val()),a.email=encodeURIComponent(u.val());var p=i.val();return""==(p=p.replace(/<(?:.|\n)*?>/gm,"").replace(/\s+/g,"").replace(/&nbsp;/g,""))?(alert(journalOptions.contentInvalidText),i.focus(),!1):""==a.Comment||"%3Cbr%3E"==a.Comment?(alert(journalOptions.contentRequiredText),i.focus(),!1):""==a.fullName?(alert(journalOptions.fullNameRequiredText),c.focus(),!1):void t.ajax({type:"POST",url:journalOptions.siteRoot+"/Product/Services/CommentService.asmx/CommentSave",data:{productId:a.productId,commentType:t(this).parents(".commentpanel").attr("data-type"),commentId:a.commentId,fullName:a.fullName,email:a.email,content:a.Comment,siteid:siteid},success:function(e){!function(e){if(i.animate({height:"0"},400,function(){l.addClass("disabled"),s.hide(),i.val("").hide(),r.show()}),""!=e&&" "!=e){var n=t(e);n.insertBefore("#"+o+" .cmteditarea"),t(n).find(".miniclose").bind("click",d),t(n).find(".cmlike").bind("click",likeComment)}}(e)},error:function(t,e,n){alert(n)}})})}}(jQuery,window);